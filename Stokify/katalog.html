<!DOCTYPE html>
<html>
<head>
  <title>Katalog Buku</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <h2>Katalog Buku</h2>
  <ul id="book-list"></ul>
  <button onclick="checkout()">Checkout</button>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="supabase.js"></script>
  <script>
    let cart = [];
    async function loadBooks() {
      const { data } = await supabase.from('books').select('*');
      const list = document.getElementById('book-list');
      data.forEach(book => {
        list.innerHTML += `
          <li>
            <img src="\${book.image_url}" width="100"><br>
            \${book.title} - \${book.author}<br>
            <input type="number" id="qty-\${book.id}" min="0" value="0">
          </li>`;
      });
    }

    function checkout() {
      document.querySelectorAll("input[type=number]").forEach(input => {
        if (input.value > 0) {
          const id = input.id.split('-')[1];
          cart.push({ id, qty: input.value });
        }
      });
      localStorage.setItem('cart', JSON.stringify(cart));
      window.location.href = 'checkout.html';
    }

    loadBooks();
  </script>
</body>
</html>
